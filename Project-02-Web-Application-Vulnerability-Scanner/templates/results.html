{% extends "base.html" %}
{% block content %}
    <h2>Scan Results for <span class="results-url">{{ url }}</span></h2>
    {% if results %}
        <div class="results-list">
        {% for result in results %}
            <div class="result-card result-{{ result.vuln | lower | replace(' ', '-') }}">
                <div class="result-header">
                    <span class="vuln-icon">
                        {% if "sql" in result.vuln|lower %}
                            <i class="fa-solid fa-database"></i>
                        {% elif "xss" in result.vuln|lower %}
                            <i class="fa-solid fa-code"></i>
                        {% elif "csrf" in result.vuln|lower %}
                            <i class="fa-solid fa-shield-halved"></i>
                        {% elif "file" in result.vuln|lower %}
                            <i class="fa-solid fa-file-alt"></i>
                        {% else %}
                            <i class="fa-solid fa-bug"></i>
                        {% endif %}
                    </span>
                    <span class="vuln-type">{{ result.vuln }}</span>
                    <span class="method-badge">{{ result.method }}</span>
                </div>
                <div class="result-body">
                    <div><span class="label">Form:</span> <code>{{ result.form }}</code></div>
                    {% if result.payload %}
                    <div><span class="label">Payload:</span> <span class="payload-highlight"><code>{{ result.payload }}</code></span></div>
                    {% endif %}
                    <div><span class="label">Evidence:</span> <span class="evidence-highlight"><code>{{ result.evidence }}</code></span></div>
                </div>
            </div>
        {% endfor %}
        </div>
    {% else %}
        <div class="no-vulns">
            <i class="fa-solid fa-shield fa-2x"></i>
            <div>No vulnerabilities found!</div>
        </div>
    {% endif %}
    <a href="{{ url_for('index') }}" class="back-link"><i class="fa-solid fa-arrow-left"></i> Scan another URL</a>
{% endblock %}