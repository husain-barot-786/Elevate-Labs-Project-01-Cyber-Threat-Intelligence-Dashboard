import requests
from bs4 import BeautifulSoup

def discover_forms(url, session=None):
    forms = []
    try:
        resp = session.get(url, timeout=10) if session else requests.get(url, timeout=10)
        soup = BeautifulSoup(resp.text, "html.parser")
        for form in soup.find_all("form"):
            inputs = []
            for inp in form.find_all("input"):
                inputs.append({
                    "name": inp.get("name"),
                    "type": inp.get("type", "text"),
                    "value": inp.get("value", "")
                })
            forms.append({
                "action": form.get("action"),
                "method": form.get("method", "get").lower(),
                "inputs": inputs
            })
    except Exception as e:
        print(f"Error discovering forms: {e}")
    return forms